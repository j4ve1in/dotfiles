#!/bin/zsh

typeset -g CMDNAME=${0##*/}

main() {
  case "$1" in
    "-u" | "--update" ) dupdate ;;
    "-d" | "--deploy" ) ddeploy ;;
    "-b" | "--backup" ) dbackup ;;
    "-r" | "--reinstall" ) dreinstall ;;
    "-U" | "--uninstall" ) duninstall ;;
    "-p" | "--install-plugin" ) dinstall -p ;;
    "-P" | "--uninstall-plugin" ) duninstall -P ;;
    "-l" | "--list" ) dlist ;;
    "-h" | "--help" )
      echo "Usage: $CMDNAME [OPTIONS]                                             "
      echo "    This script is dotfile's setup command.                           "
      echo "                                                                      "
      echo "Options:                                                              "
      echo "    -u, --update             Backup and download dotfiles             "
      echo "    -d, --deploy             Deploy dotfiles to home directory        "
      echo "    -b, --backup             Backup dotfiles to backup branch         "
      echo "    -r, --reinstall          Install dotfiles again after uninstalling"
      echo "    -U, --uninstall          Uninstall dotfiles                       "
      echo "    -l, --list               View dotfile's list                      "
      echo "    -h, --help               View help                                "
      echo "    -p, --install-plugin     Install vim, zsh and tmux plugin         "
      echo "    -P, --uninstall-plugin   Uninstall vim, zsh and tmux plugin       "
      echo "                                                                      "
      ;;
    -* )
      error_message option $(echo $1 | sed 's/^-*//')
      exit 1
      ;;
    * )
      error_message argument $1
      exit 1
      ;;
  esac
}

error_message() {
  echo "$CMDNAME: illegal $1 -- '$2'"
  echo -e "Try '$CMDNAME --help' for more information.\n"
}

main $@
